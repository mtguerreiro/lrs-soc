/*
 * ctrace.h
 *
 *  Created on: 21 de ago de 2022
 *      Author: marco
 */

#ifndef CTRACE_H_
#define CTRACE_H_

//===========================================================================
/*------------------------------- Includes --------------------------------*/
//===========================================================================
#include "stdint.h"

#include "ctrace_mem.h"
//===========================================================================

//===========================================================================
/*------------------------------ Definitions ------------------------------*/
//===========================================================================
/* Config struct */
typedef struct ctraceConfig_t{

	void *mem;
	uint32_t size;

	void **data;
	char *tags;
}ctraceConfig_t;

/* Trace context */
typedef struct ctrace_t{

	uint32_t n;
	void **data;
	char *tags;
	char *tp;
	ctracemem_t mem;
}ctrace_t;

/*
 * TODO: thread-safe?
 */
//===========================================================================

//===========================================================================
/*------------------------------- Functions -------------------------------*/
//===========================================================================
//---------------------------------------------------------------------------
void ctraceInitialize(ctrace_t *trace, ctraceConfig_t *config);
//---------------------------------------------------------------------------
void ctraceAdd(ctrace_t *trace, void *src, char *tag);
//---------------------------------------------------------------------------
void ctraceAddress(ctrace_t *trace, void *address);
//---------------------------------------------------------------------------
void ctraceReset(ctrace_t *trace);
//---------------------------------------------------------------------------
void ctraceSetSize(ctrace_t *trace, uint32_t size);
//---------------------------------------------------------------------------
uint32_t ctraceReadQtyTraces(ctrace_t *trace);
//---------------------------------------------------------------------------
uint32_t ctraceReadTags(ctrace_t *trace, char *buffer);
//---------------------------------------------------------------------------
void ctraceSave(ctrace_t *trace);
//---------------------------------------------------------------------------
//===========================================================================

#endif /* CTRACE_H_ */
