/*
 * ctrace_mem.c
 *
 *  Created on: 21 de ago de 2022
 *      Author: marco
 */

//===========================================================================
/*------------------------------- Includes --------------------------------*/
//===========================================================================
#include "ctrace_mem.h"
//===========================================================================

//===========================================================================
/*------------------------------- Functions -------------------------------*/
//===========================================================================
//---------------------------------------------------------------------------
void ctracememInitialize(ctracemem_t *trace, void *mem, uint32_t size){

	trace->start = mem;
	trace->end = mem + size;
	trace->p = mem;
}
//---------------------------------------------------------------------------
void ctracememAddress(ctracemem_t *trace, void *address){

	int *p = (int *)address;

	*p = (int)( trace->start );
}
//---------------------------------------------------------------------------
void ctracememSetSize(ctracemem_t *trace, uint32_t size){

	trace->end = trace->start + size;
	trace->p = trace->start;
}
//---------------------------------------------------------------------------
void ctracememReset(ctracemem_t *trace){

	trace->p = trace->start;
}
//---------------------------------------------------------------------------
void ctracememSave(ctracemem_t *trace, void **src, uint32_t size){

	int **s = (int **)src;

	size = size / sizeof(void *);

	if( (trace->p + size) > trace->end ) return;

	while(size--) *trace->p++ = **s++;
}
//---------------------------------------------------------------------------
//===========================================================================
