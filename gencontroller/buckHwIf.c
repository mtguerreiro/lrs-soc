/*
 * buckHwIf.c
 *
 *  Created on: 4 de set de 2022
 *      Author: marco
 */

//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "buckHwIf.h"


//=============================================================================

//=============================================================================
/*------------------------------- Definitions -------------------------------*/
//=============================================================================
#define BUCK_HW_IF_PLECS

#ifdef BUCK_HW_IF_PLECS
uint64_t *measbuffer = 0;
uint64_t *outputbuffer = 0;
#endif
//=============================================================================


//=============================================================================
/*-------------------------------- Functions --------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
int32_t buckHwIfInitialize(void){

	return 0;
}
//-----------------------------------------------------------------------------
int32_t buckHwIfGetMeas(void *meas){

#ifdef BUCK_HW_IF_PLECS

	uint32_t *p = (uint32_t *)meas;

	if( measbuffer ){
		*p = *measbuffer;

		return 1;
	}
#endif

	return 0;
}
//-----------------------------------------------------------------------------
void buckHwIfProcMeas(void *meas, void *procmeas, int32_t n){

	uint32_t *s = (uint32_t *)meas;
	uint32_t *d = (uint32_t *)procmeas;

	while(n--){
		*d++ = *s++;
	}
}
//-----------------------------------------------------------------------------
void buckHwIfProcOutputs(void *outputs, void *procoutputs, int32_t n){

	int32_t *s = (int32_t *)outputs;
	int32_t *d = (int32_t *)procoutputs;

	while(n--){
		*d++ = *s++;
	}
}
//-----------------------------------------------------------------------------
void buckHwIfApplyOutputs(void *outputs, int32_t n){

#ifdef BUCK_HW_IF_PLECS

	uint32_t *p = (uint32_t *)outputs;

	if( outputbuffer ){
		*outputbuffer = *p;
	}
#endif
}
//-----------------------------------------------------------------------------
int32_t buckHwIfSetParams(void *params, int32_t n){

#ifdef BUCK_HW_IF_PLECS

	uint64_t cmd;
	uint64_t *p = (uint64_t *)params;

	cmd = p[0];

	if( cmd == 0 ){
		measbuffer = (uint64_t *)p[1];
	}
	else if( cmd == 1 ){
		outputbuffer = (uint64_t *)p[1];
	}
	else{
		return -1;
	}

#endif

	return 0;
}
//-----------------------------------------------------------------------------
int32_t buckHwIfGetParams(void *in, void *out){

	return 0;
}
//-----------------------------------------------------------------------------
//=============================================================================
